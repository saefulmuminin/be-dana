DANA Widget APIRefund Order
Refund Order
POST
/v1.0/debit/refund.htm
This API is used to refund the order from merchant's platform to DANA

API Type
SNAP API
Expected Timeout
8 second
SNAP Service Code
58

Show API Details
This API is used for the following solution:
DANA Widget Binding
Seamlessly integrate DANA payments into merchant's platform, allowing customers to link their DANA accounts for faster, smoother transactions across all merchant's services.
This API is used for the following solution:
DANA Widget Non Binding
Integrate DANA as a payment method in merchant's platform without account binding. Users simply select DANA, get redirected to the DANA App, and complete payments using their DANA account.

Request Headers
Content-Type
string
1 - 127 characters
Required
Content type, value always application/json
X-TIMESTAMP
string
25 characters
Required
Transaction date time, in format YYYY-MM-DDTHH:mm:ss+07:00. Time must be in GMT+7 (Jakarta time)
X-SIGNATURE
string
Required
Signature need to be generated with asymmetricSignature method
ORIGIN
string
Origin domain
X-PARTNER-ID
string
1 - 36 characters
Required
Unique identifier for partner was generated by DANA, or known as clientId
X-EXTERNAL-ID
string
1 - 36 characters
Required
Unique messaging reference identifier generated by merchant and should be unique within the same day
CHANNEL-ID
string
1 - 5 characters
Required
Device identification on which the API services is currently being accessed by the end user (customer)

Request Body
merchantId
string
1 - 64 characters
Required
Merchant identifier that is unique per each merchant
subMerchantId
string
1 - 32 characters
Sub merchant identifier, known as externalDivisionId must be registered in the DANA system before use. To register a new externalDivisionId, use the Create Division API
originalReferenceNo
string
1 - 64 characters
Original transaction identifier on DANA system
originalPartnerReferenceNo
string
1 - 64 characters
Required
Original transaction identifier on partner system
originalExternalId
string
1 - 36 characters
Original external identifier on header message
originalCaptureNo
string
1 - 64 characters
Conditional
DANA's capture identifier. Use to refund the corresponding capture order
Conditional Info
Y:= Auth Payment scenario
partnerRefundNo
string
1 - 64 characters
Required
Reference number from merchant for the refund
refundAmount
money
Required
Refund amount. Contains two sub-fields:

1. Value: Amount, including the cents
2. Currency: Currency code based on ISO

Show object details
externalStoreId
string
1 - 64 characters
Store identifier to indicate to which store this payment belongs to, known as externalShopId must be registered in the DANA system before use. To register a new externalShopId, use the Create Shop API
reason
string
1 - 256 characters
Refund reason
additionalInfo
json object
Additional information
additionalInfo.payoutAccountNo
string
1 - 64 characters
Additional information of payout account number. This param need to be filled if want to refund to specific payout account not that specified by DANA
additionalInfo.refundAppliedTime
string
25 characters
Additional information of refund applied time, in format YYYY-MM-DDTHH:mm:ss+07:00. Time must be in GMT+7 (Jakarta time)
additionalInfo.actorType
string
1 - 64 characters
Additional information of actor type, refer to ActorTypeEnum
USER
string
User
MERCHANT
string
Merchant
MERCHANT_OPERATOR
string
Merchant operator
BACK_OFFICE
string
Back office
SYSTEM
string
System
additionalInfo.returnChargeToPayer
string
1 - 64 characters
Additional information of return charge to payer
additionalInfo.destination
string
1 - 64 characters
Additional information of destination
additionalInfo.envInfo
json object
Additional information of environment

Show object details
additionalInfo.auditInfo
json object
Additional information of audit

Show object details
additionalInfo.actorContext
json object
Additional information of actor context

Show object details
additionaInfo.refundOptionBill
array of json object
Additional information of refund option bill

Show object details

additionalInfo.extendInfo
string
1 - 4096 characters
Additional information of extend
additionalInfo.asyncRefund
string
1 - 5 characters
Additional information of async refund to determine the process of refund whether sync or async. The values is true / false

Request Sample
JSON
POST .../v1.0/debit/refund.htm HTTP/1.2
Content-type: application/json
X-TIMESTAMP: 2020-12-23T07:44:11+07:00
X-SIGNATURE: 85be817c55b2c135157c7e89f52499bf0c25ad6eeebe04a986e8c862561b19a5
ORIGIN: <www.hostname.com>
X-PARTNER-ID: 82150823919040624621823174737537
X-EXTERNAL-ID: 41807553358950093184162180797837
CHANNEL-ID: 95221
{
    "merchantId":"00007100010926",
    "subMerchantId":"310928924949487",
    "originalPartnerReferenceNo":"2020102900000000000001",
    "originalReferenceNo":"2020102977770000000009",
    "originalExternalId":"30443786930722726463280097920912",
    "originalCaptureNo": "202010173821904898012234423",
    "partnerRefundNo":"239850918204981205970",
    "refundAmount":{
      "value":"10000.00",
      "currency":"IDR"
    },
    "externalStoreId":"124928924949487",
    "reason":"Customer complain",
    "additionalInfo":{
      "payoutAccountNo": "20050000000001503276",
      "refundAppliedTime": "2001-07-04T12:08:56+07:00",
      "actorType": "BACK_OFFICE",
      "returnChargeToPayer": true,
      "destination": "TO_BALANCE",
      "envInfo": {
          "sessionId": "8EU6mLl5mUpUBgyRFT4v7DjfQ3fcauthcenter",
          "tokenId": "a8d359d6-ca3d-4048-9295-bbea5f6715a6",
          "websiteLanguage": "en_US",
          "clientIp": "10.15.8.189",
          "osType": "Windows.PC",
          "appVersion": "1.0",
          "sdkVersion": "1.0",
          "sourcePlatform": "IPG",
          "terminalType": "SYSTEM",
          "orderTerminalType": "APP",
          "orderOsType": "IOS",
          "merchantAppVersion": "1.0",
          "extendInfo": "{\"deviceId\":\"CV19A56370e8a00d54293aab8001e4794\", \"bizScenario\":\"SAMPLE_MERCHANT_AGENT\"}"
      },
      "auditInfo": {
          "actionReason": "user claim",
          "thirdClientId": "2016061912345678900987654321234"
      },
      "actorContext": {
          "actorId": "224234234",
          "actorType": "BACK_OFFICE"
      },
      "refundOptionBill": [
          {
          "payMethod": "BALANCE",
          "transAmount": {
              "currency": "IDR",
              "value": "100.00"
            }
          }
      ],
      "extendInfo": {},
      "asyncRefund": "true"
    }
}

Response Headers
Content-Type
string
1 - 127 characters
Required
Content type, value always application/json
X-TIMESTAMP
string
25 characters
Required
Transaction date time, in format YYYY-MM-DDTHH:mm:ss+07:00. Time must be in GMT+7 (Jakarta time)

Response Body
responseCode
string
7 characters
Required
Refer to response code list
responseMessage
string
1 - 150 characters
Required
Refer to response code list
originalReferenceNo
string
1 - 64 characters
Conditional
Original transaction identifier on DANA system
Conditional Info
Y:= Successfully processed
originalPartnerReferenceNo
string
1 - 64 characters
Required
Original transaction identifier on partner system
originalExternalId
string
1 - 36 characters
Original external identifier on header message
originalCaptureNo
string
1 - 64 characters
Conditional
DANA’s capture identifier. Use to refund the corresponding capture order
Conditional Info
Y:= Auth Payment scenario
refundNo
string
1 - 64 characters
Conditional
Refund number identifier on DANA system
Conditional Info
Y:= Successfully processed
partnerRefundNo
string
1 - 64 characters
Required
Reference number from merchant for the refund
refundAmount
[money
Required
Refund amount. Contains two sub-fields:

1. Value: Amount, including the cents
2. Currency: Currency code based on ISO
refundTime
string
25 characters
Conditional
Refund time, in format YYYY-MM-DDTHH:mm:ss+07:00. Time must be in GMT+7 (Jakarta time)
Conditional Info
Y:= Successfully processed
additionalInfo
json object
Additional information

Response Sample
JSON
Content-type: application/json
X-TIMESTAMP: 2020-12-23T07:44:16+07:00
{
    "responseCode":"2005800",
    "responseMessage":"Successful",
    "originalPartnerReferenceNo":"2020102900000000000001",
    "originalReferenceNo":"2020102977770000000009",
    "originalExternalId":"30443786930722726463280097920912",
    "originalCaptureNo": "202010173821904898012234423",
    "refundNo":"REF993883",
    "partnerRefundNo":"239850918204981205970",
    "refundAmount":{
        "value":"10000.00",
        "currency":"IDR"
    },
    "refundTime":"2020-12-21T17:21:41+07:00",
    "additionalInfo":{}
}

Response Codes List
Response Cause Solution
2005800
Successful
Success to be processed 
Mark Refund Order process as Success
2025800
Request In Progress
Transaction is on process 
Mark Refund Order process as Pending. Retry request periodically by sending same request payload
4005800
Bad Request
General request failed error 
Mark Refund Order process as Failed. Retry request with proper parameter
4005801
Invalid Field Format
Invalid format for certain field 
Mark Refund Order process as Failed. Retry request with proper parameter
4005802
Invalid Mandatory Field
Missing or invalid format on mandatory field 
Mark Refund Order process as Failed. Retry request with proper parameter
4015800
Unauthorized. [reason]
General unauthorized error 
Mark Refund Order process as Failed. Retry request with proper parameter
4035802
Exceeds Transaction Amount Limit
Exceeds transaction amount limit 
Mark Refund Order process as Failed. Try to adjust the amount of money that want to be refunded
4035805
Do Not Honor
Account or user status is abnormal 
Mark Refund Order process as Failed. Retry request with proper parameter or can contact to DANA to check the user/account status
4035814
Insufficient Funds
Insufficient funds of merchant’s account to refund the order 
Mark Refund Order process as Failed. Retry request periodically
4035815
Transaction Not Permitted.[reason]
Transaction not permitted 
Mark Refund Order process as Failed. Retry request periodically or can consult to DANA
4045800
Invalid Transaction Status
Invalid transaction status 
Mark Refund Order process as Failed. Retry request periodically or can consult to DANA
4045808
Invalid Merchant
Merchant does not exist or status abnormal 
Mark Refund Order process as Failed. Retry request with proper parameter
4045812
Invalid Bill/Virtual Account [Reason]
• The bill is blocked/ suspended/not found • Virtual account is suspend/not found 
Mark Refund Order process as Failed. Retry request with proper parameter
4045813
Invalid Amount
The amount doesn't match with what supposed to 
Mark Refund Order process as Failed. Retry request with proper parameter
4045818
Inconsistent Request
Inconsistent request parameter found for the same partner reference number/transaction identifier 
Mark Refund Order process as Pending. Need to investigate the root cause and retry request with proper parameter
4295800
Too Many Requests
Maximum transaction limit exceeded 
Mark Refund Order process as Pending. Retry request periodically by sending same request payload
5005800
General Error
General error non retry-able 
Mark Refund Order process as Failed. Retry request periodically
5005801
Internal Server Error
Unknown internal server failure, please retry the process again 
Mark Refund Order process as Pending. Retry request periodically by sending same request payload
Total timeout
Total timeout, the client side does not get any responses from the server side (Can be due to network issue, server slowing down, and so on) 
Do a retry maximum 3 attempts by sending same request payload, if still fails mark Refund Order process as Pending
Unexpected response (Empty field/field does not exist/undefined response code)
The server does not produce expected responses (Can be due to hardware failure, bugs, and so on) 
If the response code prefix are 202 and 5XX, mark Refund Order process as Pending.
If empty field/field does not exist, mark Refund Order process as Pending.
